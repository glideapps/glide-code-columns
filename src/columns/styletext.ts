import * as glide from "../glide";

// Maps input char to output char.
// Any unlisted chars will remain unchanged.
type StyleMap = Record<string, string>;

const styles = [
  "script",
  "gothic",
  "smallcaps",
  "doublestruck",
  "fullwidth",
  "superscript",
];

const styleMaps: Record<string, StyleMap> = {
  script: {
    A: "ğ“",
    B: "ğ“‘",
    C: "ğ“’",
    D: "ğ““",
    E: "ğ“”",
    F: "ğ“•",
    G: "ğ“–",
    H: "ğ“—",
    I: "ğ“˜",
    J: "ğ“™",
    K: "ğ“š",
    L: "ğ“›",
    M: "ğ“œ",
    N: "ğ“",
    O: "ğ“",
    P: "ğ“Ÿ",
    Q: "ğ“ ",
    R: "ğ“¡",
    S: "ğ“¢",
    T: "ğ“£",
    U: "ğ“¤",
    V: "ğ“¥",
    W: "ğ“¦",
    X: "ğ“§",
    Y: "ğ“¨",
    Z: "ğ“©",
    a: "ğ“ª",
    b: "ğ“«",
    c: "ğ“¬",
    d: "ğ“­",
    e: "ğ“®",
    f: "ğ“¯",
    g: "ğ“°",
    h: "ğ“±",
    i: "ğ“²",
    j: "ğ“³",
    k: "ğ“´",
    l: "ğ“µ",
    m: "ğ“¶",
    n: "ğ“·",
    o: "ğ“¸",
    p: "ğ“¹",
    q: "ğ“º",
    r: "ğ“»",
    s: "ğ“¼",
    t: "ğ“½",
    u: "ğ“¾",
    v: "ğ“¿",
    w: "ğ”€",
    x: "ğ”",
    y: "ğ”‚",
    z: "ğ”ƒ",
  },
  gothic: {
    A: "ğ•¬",
    B: "ğ•­",
    C: "ğ•®",
    D: "ğ•¯",
    E: "ğ•°",
    F: "ğ•±",
    G: "ğ•²",
    H: "ğ•³",
    I: "ğ•´",
    J: "ğ•µ",
    K: "ğ•¶",
    L: "ğ•·",
    M: "ğ•¸",
    N: "ğ•¹",
    O: "ğ•º",
    P: "ğ•»",
    Q: "ğ•¼",
    R: "ğ•½",
    S: "ğ•¾",
    T: "ğ•¿",
    U: "ğ–€",
    V: "ğ–",
    W: "ğ–‚",
    X: "ğ–ƒ",
    Y: "ğ–„",
    Z: "ğ–…",
    a: "ğ–†",
    b: "ğ–‡",
    c: "ğ–ˆ",
    d: "ğ–‰",
    e: "ğ–Š",
    f: "ğ–‹",
    g: "ğ–Œ",
    h: "ğ–",
    i: "ğ–",
    j: "ğ–",
    k: "ğ–",
    l: "ğ–‘",
    m: "ğ–’",
    n: "ğ–“",
    o: "ğ–”",
    p: "ğ–•",
    q: "ğ––",
    r: "ğ–—",
    s: "ğ–˜",
    t: "ğ–™",
    u: "ğ–š",
    v: "ğ–›",
    w: "ğ–œ",
    x: "ğ–",
    y: "ğ–",
    z: "ğ–Ÿ",
  },
  smallcaps: {
    a: "á´€",
    b: "Ê™",
    c: "á´„",
    d: "á´…",
    e: "á´‡",
    f: "êœ°",
    g: "É¢",
    h: "Êœ",
    i: "Éª",
    j: "á´Š",
    k: "á´‹",
    l: "ÊŸ",
    m: "á´",
    n: "É´",
    o: "á´",
    p: "á´˜",
    q: "Ç«",
    r: "Ê€",
    s: "êœ±",
    t: "á´›",
    u: "á´œ",
    v: "á´ ",
    w: "á´¡",
    y: "Ê",
    z: "á´¢",
  },
  doublestruck: {
    "0": "ğŸ˜",
    "1": "ğŸ™",
    "2": "ğŸš",
    "3": "ğŸ›",
    "4": "ğŸœ",
    "5": "ğŸ",
    "6": "ğŸ",
    "7": "ğŸŸ",
    "8": "ğŸ ",
    "9": "ğŸ¡",
    A: "ğ”¸",
    B: "ğ”¹",
    C: "â„‚",
    D: "ğ”»",
    E: "ğ”¼",
    F: "ğ”½",
    G: "ğ”¾",
    H: "â„",
    I: "ğ•€",
    J: "ğ•",
    K: "ğ•‚",
    L: "ğ•ƒ",
    M: "ğ•„",
    N: "â„•",
    O: "ğ•†",
    P: "â„™",
    Q: "â„š",
    R: "â„",
    S: "ğ•Š",
    T: "ğ•‹",
    U: "ğ•Œ",
    V: "ğ•",
    W: "ğ•",
    X: "ğ•",
    Y: "ğ•",
    Z: "â„¤",
    a: "ğ•’",
    b: "ğ•“",
    c: "ğ•”",
    d: "ğ••",
    e: "ğ•–",
    f: "ğ•—",
    g: "ğ•˜",
    h: "ğ•™",
    i: "ğ•š",
    j: "ğ•›",
    k: "ğ•œ",
    l: "ğ•",
    m: "ğ•",
    n: "ğ•Ÿ",
    o: "ğ• ",
    p: "ğ•¡",
    q: "ğ•¢",
    r: "ğ•£",
    s: "ğ•¤",
    t: "ğ•¥",
    u: "ğ•¦",
    v: "ğ•§",
    w: "ğ•¨",
    x: "ğ•©",
    y: "ğ•ª",
    z: "ğ•«",
  },
  fullwidth: {
    "!": "ï¼",
    '"': "ï¼‚",
    "#": "ï¼ƒ",
    $: "ï¼„",
    "%": "ï¼…",
    "&": "ï¼†",
    "'": "ï¼‡",
    "(": "ï¼ˆ",
    ")": "ï¼‰",
    "*": "ï¼Š",
    "+": "ï¼‹",
    ",": "ï¼Œ",
    "-": "ï¼",
    ".": "ï¼",
    "/": "ï¼",
    "0": "ï¼",
    "1": "ï¼‘",
    "2": "ï¼’",
    "3": "ï¼“",
    "4": "ï¼”",
    "5": "ï¼•",
    "6": "ï¼–",
    "7": "ï¼—",
    "8": "ï¼˜",
    "9": "ï¼™",
    ":": "ï¼š",
    ";": "ï¼›",
    "<": "ï¼œ",
    "=": "ï¼",
    ">": "ï¼",
    "?": "ï¼Ÿ",
    "@": "ï¼ ",
    A: "ï¼¡",
    B: "ï¼¢",
    C: "ï¼£",
    D: "ï¼¤",
    E: "ï¼¥",
    F: "ï¼¦",
    G: "ï¼§",
    H: "ï¼¨",
    I: "ï¼©",
    J: "ï¼ª",
    K: "ï¼«",
    L: "ï¼¬",
    M: "ï¼­",
    N: "ï¼®",
    O: "ï¼¯",
    P: "ï¼°",
    Q: "ï¼±",
    R: "ï¼²",
    S: "ï¼³",
    T: "ï¼´",
    U: "ï¼µ",
    V: "ï¼¶",
    W: "ï¼·",
    X: "ï¼¸",
    Y: "ï¼¹",
    Z: "ï¼º",
    "[": "ï¼»",
    "\\": "ï¼¼",
    "]": "ï¼½",
    "^": "ï¼¾",
    _: "ï¼¿",
    "`": "ï½€",
    a: "ï½",
    b: "ï½‚",
    c: "ï½ƒ",
    d: "ï½„",
    e: "ï½…",
    f: "ï½†",
    g: "ï½‡",
    h: "ï½ˆ",
    i: "ï½‰",
    j: "ï½Š",
    k: "ï½‹",
    l: "ï½Œ",
    m: "ï½",
    n: "ï½",
    o: "ï½",
    p: "ï½",
    q: "ï½‘",
    r: "ï½’",
    s: "ï½“",
    t: "ï½”",
    u: "ï½•",
    v: "ï½–",
    w: "ï½—",
    x: "ï½˜",
    y: "ï½™",
    z: "ï½š",
    "{": "ï½›",
    "|": "ï½œ",
    "}": "ï½",
    "~": "ï½",
    "Â¢": "ï¿ ",
    "Â£": "ï¿¡",
    "Â¥": "ï¿¥",
    "Â¦": "ï¿¤",
    "Â¬": "ï¿¢",
    "Â¯": "ï¿£",
    "â‚©": "ï¿¦",
    "â¸¨": "ï½Ÿ",
    "â¸©": "ï½ ",
  },
  superscript: {
    "0": "â°",
    "1": "Â¹",
    "2": "Â²",
    "3": "Â³",
    "4": "â´",
    "5": "âµ",
    "6": "â¶",
    "7": "â·",
    "8": "â¸",
    "9": "â¹",
    A: "á´¬",
    B: "á´®",
    C: "á¶œ",
    D: "á´°",
    E: "á´±",
    F: "á¶ ",
    G: "á´³",
    H: "á´´",
    I: "á´µ",
    J: "á´¶",
    K: "á´·",
    L: "á´¸",
    M: "á´¹",
    N: "á´º",
    O: "á´¼",
    P: "á´¾",
    R: "á´¿",
    S: "Ë¢",
    T: "áµ€",
    U: "áµ",
    V: "â±½",
    W: "áµ‚",
    X: "Ë£",
    Y: "Ê¸",
    Z: "á¶»",
    a: "áµƒ",
    b: "áµ‡",
    c: "á¶œ",
    d: "áµˆ",
    e: "áµ‰",
    f: "á¶ ",
    g: "áµ",
    h: "Ê°",
    i: "â±",
    j: "Ê²",
    k: "áµ",
    l: "Ë¡",
    m: "áµ",
    n: "â¿",
    o: "áµ’",
    p: "áµ–",
    r: "Ê³",
    s: "Ë¢",
    t: "áµ—",
    u: "áµ˜",
    v: "áµ›",
    w: "Ê·",
    x: "Ë£",
    y: "Ê¸",
    z: "á¶»",
  },
};

export default glide
  .columnNamed("Style Text")
  .withCategory("Fun")
  .withDescription(
    `Make text into smallcaps, cursive, upside down, etc. Output is copy-pastable!`
  )
  .withStringResult()
  .withRequiredStringParam("text", "Text to style")
  .withRequiredStringParam("style", `Style (${styles.join(", ")})`)

  .withTest({ text: "Hello world", style: "script" }, "ğ“—ğ“®ğ“µğ“µğ“¸ ğ”€ğ“¸ğ“»ğ“µğ“­")
  .withTest({ text: "Unknown style", style: "wrong" }, undefined)

  .run(({ text, style }) => {
    const styleMap = styleMaps[style];
    if (styleMap === undefined) {
      return undefined;
    }
    return [...text].map(char => styleMap[char] ?? char).join("");
  });
